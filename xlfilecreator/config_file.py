import pandas as pd
import xlsxwriter

from .formats import format_dict, format_lock_config_dict

### header=None
MAIN = {0: {0: 'CONFIG_MANAGER', 1: 'column_width', 2: 'conditional_formatting', 3: 'header_format', 4: 'lock_sheet_config', 5: 'formula', 6: 'description_header', 7: 'HEADER', 8: 'example_row'}, 1: {0: '"=ArrayFormula(if(offset(B1:1,match("HEADER",A:A,0)-1,0)="","",column(offset(B1:1,match("HEADER",A:A,0)-1,0))-2))', 1: '8', 2: '', 3: 'rsr_format_4', 4: 'locked_hidden_grey', 5: '', 6: '"=ARRAYFORMULA(IMPORT_FILE!A1:AA)', 7: '', 8: ''}, 2: {0: '', 1: '25', 2: '', 3: 'rsr_format_5', 4: 'LOCKED', 5: '', 6: '', 7: '', 8: ''}, 3: {0: '', 1: '40', 2: '', 3: 'rsr_format_6', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 4: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_7', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 5: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_8', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 6: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_9', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 7: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_0', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 8: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_1', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 9: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_2', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 10: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_4', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 11: {0: '', 1: '25', 2: '', 3: 'rsr_format_5', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 12: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_6', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 13: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_7', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 14: {0: '', 1: '25', 2: '', 3: 'rsr_format_8', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 15: {0: '', 1: '25', 2: '', 3: 'format_1', 4: 'locked_hidden_wrap_grey', 5: '\\=IF(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4))="","",IF(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4))=TEXT(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4)),"dd mmmm yyyy"),"INVALID_DATE_FORMAT",TEXT(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4)),"dd mmmm yyyy")))', 6: '', 7: '', 8: ''}, 16: {0: '', 1: '25', 2: '', 3: 'rsr_format_13', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 17: {0: '', 1: '25', 2: 'Mandatory', 3: 'format_1', 4: 'locked_hidden_wrap_grey', 5: '\\=IF(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4))="","",IF(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4))=TEXT(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4)),"dd mmmm yyyy"),"INVALID_DATE_FORMAT",TEXT(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4)),"dd mmmm yyyy")))', 6: '', 7: '', 8: ''}, 18: {0: '', 1: '25', 2: '', 3: 'rsr_format_13', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 19: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_7', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 20: {0: '', 1: '25', 2: '', 3: 'rsr_format_13', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 21: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_7', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 22: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_13', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 23: {0: '', 1: '25', 2: '', 3: 'format_1', 4: 'locked_hidden_wrap_grey', 5: '\\=IF(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4))="","",IF(LEFT(INDIRECT(ADDRESS(ROW(),COLUMN()-1,4)),2)<>"47","INVALID_PO"&CHAR(10)&"MUST START WITH 47","OK"))', 6: '', 7: '', 8: ''}, 24: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_13', 4: 'unlocked_text', 5: '', 6: '', 7: '', 8: ''}, 25: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_12', 4: 'unlocked_pounds', 5: '', 6: '', 7: '', 8: ''}, 26: {0: '', 1: '25', 2: 'Mandatory', 3: 'rsr_format_13', 4: 'unlocked_percent', 5: '', 6: '', 7: '', 8: ''}, 27: {0: '', 1: '25', 2: '', 3: 'rsr_format_12', 4: 'locked_hidden_grey_number', 5: '\\=IF(INDIRECT("Y"&ROW())="","Fill in the PayRate",IF(INDIRECT("Z"&ROW())="","Fill in the Markup",INDIRECT("Y"&ROW())*(1+INDIRECT("Z"&ROW()))))', 6: '', 7: '', 8: ''}}
df_main = pd.DataFrame(MAIN)

### header=None
ROOT = {0: {0: '', 1: 'ID', 2: 'ABCWO0000XXXX', 3: 'ABCWO00010374', 4: 'ABCWO00010700', 5: 'ABCWO00010701', 6: 'ABCWO00008134', 7: 'ABCWO00007523', 8: 'ABCWO00008133', 9: 'ABCWO00009763', 10: 'ABCWO00009877', 11: 'ABCWO00010401', 12: 'ABCWO00008857', 13: 'ABCWO00009381', 14: 'ABCWO00010232', 15: 'ABCWO00010386', 16: 'ABCWO00010528', 17: 'ABCWO00009305', 18: 'ABCWO00010660', 19: 'ABCWO00010661', 20: 'ABCWO00009662', 21: 'ABCWO00010297', 22: 'ABCWO00010850'}, 1: {0: '', 1: 'Supplier', 2: 'Supplier ABC', 3: 'Point Recruitment (UK)', 4: 'Point Recruitment (UK)', 5: 'Point Recruitment (UK)', 6: 'Black Diamond Networks', 7: 'Talentburst, Inc', 8: 'Black Diamond Networks', 9: 'Modis Inc.', 10: 'Talentburst, Inc', 11: 'inSync Staffing Inc.', 12: 'Talentburst, Inc', 13: 'Black Diamond Networks', 14: 'Talentburst, Inc', 15: 'inSync Staffing Inc.', 16: 'inSync Staffing Inc.', 17: 'inSync Staffing Inc.', 18: 'Modis Inc.', 19: 'Modis Inc.', 20: 'Talentburst, Inc', 21: 'Talentburst, Inc', 22: 'Modis Inc.'}, 2: {0: 'Text (optional)', 1: 'Supplier comment', 2: '', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: 'Original Start 10/25/21', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: 'Flex role. Remote and onsite', 21: '', 22: ''}, 3: {0: 'Text', 1: 'Worker Email', 2: 'worker_email&email.com', 3: 'worker1@email.com', 4: 'worker2@email.com', 5: 'worker3@email.com', 6: 'worker4@email.com', 7: 'worker5@email.com', 8: 'worker6@email.com', 9: 'worker7@email.com', 10: 'worker8@email.com', 11: 'worker9@email.com', 12: 'worker10@email.com', 13: 'worker11@email.com', 14: 'worker12@email.com', 15: 'worker13@email.com', 16: 'worker14@email.com', 17: 'worker15@email.com', 18: 'worker16@email.com', 19: 'worker17@email.com', 20: 'worker18@email.com', 21: 'worker19@email.com', 22: 'worker20@email.com'}, 4: {0: 'Text', 1: 'First Name', 2: 'Scottie', 3: 'Patt', 4: 'Richard', 5: 'Evija', 6: 'Ahmed', 7: 'Tanya', 8: 'Vladimir', 9: 'Tamicia', 10: 'Angela', 11: 'Richard', 12: 'Brett', 13: 'Ambra', 14: 'Perish', 15: 'Ernest', 16: 'Renata', 17: 'Nicole', 18: 'Glen', 19: 'Robert', 20: 'George', 21: 'Robert', 22: 'Sean'}, 5: {0: 'Text', 1: 'Last Name', 2: 'Smith', 3: 'Szutta', 4: 'Moss', 5: 'Jansone', 6: "O'keefe", 7: 'Churchman', 8: 'Mattison', 9: 'Scarbrough', 10: 'Swims', 11: 'Lane', 12: 'Davis', 13: 'Robinson', 14: 'Bolden', 15: 'Brown', 16: 'Johnson', 17: 'Gregory', 18: 'Evans', 19: 'Coleman', 20: 'Pollard', 21: 'Marshall', 22: 'Mohammed'}, 6: {0: 'Dropdown', 1: 'ACTIVE WORKER?', 2: 'Yes', 3: 'Yes', 4: 'Yes', 5: 'Yes', 6: 'Yes', 7: 'Yes', 8: 'LEAVER', 9: 'Yes', 10: 'Yes', 11: 'Yes', 12: 'Yes', 13: 'LEAVER', 14: 'Yes', 15: 'Yes', 16: 'Yes', 17: 'Yes', 18: 'Yes', 19: 'Yes', 20: 'Yes', 21: 'Yes', 22: 'Yes'}, 7: {0: 'Dropdown', 1: 'Job Class Short Name', 2: 'Legal', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 8: {0: 'Dropdown', 1: 'Job Title', 2: 'Legal Operations', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 9: {0: 'Dropdown', 1: 'Salary Class', 2: 'Senior', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 10: {0: 'Dropdown', 1: 'IR35 Status', 2: 'Inside', 3: 'Inside', 4: 'Inside', 5: 'Outside', 6: 'Inside', 7: 'Outside', 8: 'Inside', 9: 'Outside', 10: '', 11: '', 12: 'Inside', 13: 'Outside', 14: 'Inside', 15: 'Outside', 16: '', 17: '', 18: 'Inside', 19: 'Outside', 20: '', 21: '', 22: ''}, 11: {0: 'Dropdown', 1: 'Worker Gender', 2: 'Unknown', 3: 'Female', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 12: {0: 'Text', 1: 'Worker Address Line 1', 2: '24 Thirsk Road', 3: '16 West End', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 13: {0: 'Date (DD/MM/YYYY)', 1: 'Current Assignment Start Date', 2: '30/04/2022', 3: '17/07/2022', 4: '06/06/2022', 5: '13/06/2022', 6: '05/07/2022', 7: '08/01/2022', 8: '12/15/2021', 9: '04/02/2022', 10: '04/24/2022', 11: '05/01/2022', 12: '11/13/2021', 13: '08/09/2021', 14: '12/08/2021', 15: '02/07/2022', 16: '04/25/2022', 17: '', 18: '11/27/2021', 19: '05/31/2022', 20: '08/29/2022', 21: '01/21/2022', 22: '01/01/2022'}, 14: {0: 'CHECK', 1: 'Validation Start Date', 2: 'OK', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 15: {0: 'Date (DD/MM/YYYY)', 1: 'Current Assignment End Date', 2: '23/11/2022', 3: '16/01/2023', 4: '05/12/2022', 5: '05/12/2022', 6: '11/12/2022', 7: '12/31/2022', 8: '06/01/2022', 9: '07/30/2022', 10: '09/26/2022', 11: '12/31/2022', 12: '07/31/2022', 13: '06/13/2022', 14: '11/20/2022', 15: '01/03/2023', 16: '04/10/2023', 17: '', 18: '07/01/2022', 19: '02/25/2023', 20: '12/31/2022', 21: '09/22/2022', 22: '08/01/2022'}, 16: {0: 'CHECK', 1: 'Validation End Date', 2: 'OK', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 17: {0: 'Dropdown', 1: 'Notice Period', 2: '30 days', 3: 'N/A', 4: 'N/A', 5: 'N/A', 6: 'N/A', 7: 'N/A', 8: '', 9: 'N/A', 10: 'N/A', 11: 'N/A', 12: '', 13: '2 weeks', 14: 'N/A', 15: 'N/A', 16: 'N/A', 17: '1 month', 18: 'N/A', 19: '', 20: '2 weeks', 21: '', 22: ''}, 18: {0: 'Dropdown', 1: 'Remote worker?', 2: 'Yes', 3: 'No', 4: '', 5: '', 6: 'Yes', 7: 'No', 8: 'No', 9: 'Yes', 10: 'No', 11: 'Yes', 12: 'No', 13: 'Yes', 14: 'No', 15: 'Yes', 16: 'Yes', 17: '', 18: 'No', 19: 'No', 20: 'Yes', 21: 'No', 22: 'No'}, 19: {0: 'Mandatory for remote workers', 1: 'State in which the worker is based', 2: 'MD - Maryland', 3: 'IA - Iowa', 4: '', 5: '', 6: '', 7: '', 8: '', 9: 'MN - Minnesota', 10: '', 11: 'TX - Texas', 12: '', 13: 'NY - New York', 14: '', 15: '', 16: '', 17: '', 18: 'TN - Tennessee', 19: '', 20: 'FL - Florida', 21: '', 22: ''}, 20: {0: 'Dropdown', 1: 'Worker Pay Type Name', 2: 'PAYE', 3: 'PAYE', 4: 'LTD', 5: 'LTD Inside IR35', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 21: {0: "MUST START WITH '47'", 1: 'PO Number', 2: '4700000000', 3: '12312', 4: 'HHHH-34FDS', 5: '344356', 6: '37645465', 7: '47654365', 8: '4736536', 9: '', 10: '', 11: '', 12: '000234235', 13: '043', 14: '56354635', 15: '', 16: '', 17: '473452435', 18: '4252', 19: '5363', 20: '', 21: '', 22: ''}, 22: {0: 'CHECK', 1: 'VALIDATION PO', 2: 'OK', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}, 23: {0: 'Dropdown', 1: 'Rate type', 2: 'Hourly', 3: 'Hourly', 4: '', 5: '', 6: 'Hourly', 7: 'Daily', 8: 'Hourly', 9: 'Hourly', 10: 'Hourly', 11: 'Daily', 12: 'Hourly', 13: 'Hourly', 14: 'Hourly', 15: 'Hourly', 16: 'Hourly', 17: '', 18: 'Hourly', 19: 'Hourly', 20: 'Hourly', 21: 'Hourly', 22: 'Hourly'}, 24: {0: 'Amount', 1: 'Standard Pay Rate', 2: '40.00', 3: '10.36', 4: '', 5: '', 6: '100', 7: '360', 8: '84', 9: '61.76', 10: '27.5', 11: '200', 12: '33', 13: '72', 14: '40', 15: '22', 16: '22', 17: '', 18: '121.44', 19: '56', 20: '37', 21: '47', 22: '136.94'}, 25: {0: 'Percentage %', 1: 'Markup %', 2: '0.10', 3: '', 4: '', 5: '', 6: '', 7: '0.12', 8: '0.15', 9: '0.1245', 10: '0.1133', 11: '0.0244', 12: '', 13: '', 14: '0.10', 15: '0.15', 16: '0.35', 17: '', 18: '', 19: '0.3', 20: '', 21: '', 22: ''}, 26: {0: 'Amount', 1: 'Standard Supplier Bill Rate', 2: '44', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: ''}}
df_impf = pd.DataFrame(ROOT)

### header=None
D_VALIDATION_1 = {0: {0: 'Index', 1: 'error_type', 2: 'input_title', 3: 'input_message', 4: 'error_title', 5: 'error_message', 6: 'HEADER', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 1: {0: '"=ArrayFormula(if(offset(B1:1,match("HEADER",$A:$A,0)-1,0)="","",column(offset(B1:1,match("HEADER",$A:$A,0)-1,0))-2))', 1: '', 2: '', 3: '', 4: 'Worker Gender ERROR TITLE', 5: '', 6: 'Worker Gender', 7: 'Male', 8: 'Female', 9: 'Unknown', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 2: {0: '', 1: 'information', 2: '', 3: '', 4: '', 5: '', 6: 'Worker Pay Type Name', 7: 'PAYE', 8: 'Umbrella', 9: 'LTD', 10: 'LTD Inside IR35', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 3: {0: '', 1: 'stop', 2: 'Active worker?', 3: 'Is this worker an active employee?', 4: '', 5: 'it must be an option from the picklist', 6: 'ACTIVE WORKER?', 7: 'Yes', 8: 'LEAVER', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 4: {0: '', 1: 'stop', 2: '', 3: '', 4: '', 5: '', 6: 'Notice Period', 7: 'N/A', 8: '1 month', 9: '1 week', 10: '10 days', 11: '2 months', 12: '2 weeks', 13: '28 days', 14: '3 weeks', 15: '30 days', 16: '4 weeks', 17: '5 days', 18: '5 weeks', 19: '6 weeks', 20: '7 weeks', 21: '8 weeks', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 5: {0: '', 1: 'stop', 2: '', 3: '', 4: '', 5: '', 6: 'IR35 Status', 7: 'Inside', 8: 'Outside', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 6: {0: '', 1: 'warning', 2: '', 3: '', 4: '', 5: '', 6: 'Remote worker?', 7: 'Yes', 8: 'No', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 7: {0: '', 1: 'stop', 2: '', 3: '', 4: '', 5: '', 6: 'Rate type', 7: 'Daily', 8: 'Hourly', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: ''}, 8: {0: '', 1: 'warning', 2: '', 3: 'Select a State from the list', 4: 'What is the State of the Worker?', 5: '', 6: 'State in which the worker is based', 7: 'AL - Alabama', 8: 'AK - Alaska', 9: 'AZ - Arizona', 10: 'AR - Arkansas', 11: 'CA - California', 12: 'CO - Colorado', 13: 'CT - Connecticut', 14: 'DE - Delaware', 15: 'FL - Florida', 16: 'GA - Georgia', 17: 'HI - Hawaii', 18: 'ID - Idaho', 19: 'IL - Illinois', 20: 'IN - Indiana', 21: 'IA - Iowa', 22: 'KS - Kansas', 23: 'KY - Kentucky[D]', 24: 'LA - Louisiana', 25: 'ME - Maine', 26: 'MD - Maryland', 27: 'MA - Massachusetts[D]', 28: 'MI - Michigan', 29: 'MN - Minnesota', 30: 'MS - Mississippi', 31: 'MO - Missouri', 32: 'MT - Montana', 33: 'NE - Nebraska', 34: 'NV - Nevada', 35: 'NH - New Hampshire', 36: 'NJ - New Jersey', 37: 'NM - New Mexico', 38: 'NY - New York', 39: 'NC - North Carolina', 40: 'ND - North Dakota', 41: 'OH - Ohio', 42: 'OK - Oklahoma', 43: 'OR - Oregon', 44: 'PA - Pennsylvania[D]', 45: 'RI - Rhode Island', 46: 'SC - South Carolina', 47: 'SD - South Dakota', 48: 'TN - Tennessee', 49: 'TX - Texas', 50: 'UT - Utah', 51: 'VT - Vermont', 52: 'VA - Virginia[D]', 53: 'WA - Washington', 54: 'WV - West Virginia', 55: 'WI - Wisconsin', 56: 'WY - Wyoming'}}
dv_config1 = pd.DataFrame(D_VALIDATION_1)

D_VALIDATION_2 = {'apply_to': {0: 'Job Title', 1: 'Job Class Short Name', 2: 'Salary Class'}, 'validate': {0: 'list', 1: 'list', 2: 'list'}, 'source': {0: '\\=OFFSET(dropdown_lists_config2!$A$1,1,MATCH($H4,dropdown_lists_config2!$A$1:$P$1,0)-1,COUNTA(OFFSET(dropdown_lists_config2!$A$1,1,MATCH($H4,dropdown_lists_config2!$A$1:$P$1,0)-1,70)),1)', 1: '\\=dropdown_lists_config2!$Q$2:$Q$17', 2: '\\=dropdown_lists_config2!$R$2:$R$4'}, 'error_type': {0: 'stop', 1: 'stop', 2: 'information'}, 'input_title': {0: 'Job Title', 1: 'Job Class', 2: 'Salary Class'}, 'input_message': {0: 'The list of Job Titles is based on the Job Class', 1: '', 2: ''}, 'error_title': {0: 'Input value not valid', 1: '', 2: ''}, 'error_message': {0: 'The option do not match the picklist', 1: '', 2: ''}}
dv_config2 = pd.DataFrame(D_VALIDATION_2)

DROPDOWNS_DV2 = {'Business Integration': {0: 'Activity', 1: 'Change Management', 2: 'Innovation', 3: 'Project Manager', 4: 'S&OP', 5: 'SCRUM', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Commercial': {0: 'Commercial Research', 1: 'Buyer- Directs & Indirects', 2: 'Commercial Capability', 3: 'Commercial Effectiveness', 4: 'Commercial Insights & Analytics', 5: 'Commercial Process Owner', 6: 'Commercial Service Center', 7: 'Commercial Vendor Data', 8: 'Functional Expert- Commercial Systems', 9: 'Graphics Compliance', 10: 'Price Risk', 11: 'Risk Management Governance & Compliance', 12: 'Strategic Sourcing', 13: 'Supplier Quality Assurance', 14: 'Sustainability', 15: 'Sustainability Science', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Corporate Affairs': {0: 'Scientific Communications', 1: 'Change Communications', 2: 'Communications', 3: 'Community Engagement', 4: 'Consumer Care', 5: 'Corporate Affairs', 6: 'Digital & Social Media Communications', 7: 'E-Learning & Technical Documentation', 8: 'External Communications', 9: 'Family Liaison', 10: 'Government Relations', 11: 'Internal Communications', 12: 'Media Relations', 13: 'Public Affairs', 14: 'Stakeholder Relations', 15: 'Veterinary Clinical Nutritionist', 16: 'Veterinary Scientific Services', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Data, Analytics & Insights': {0: 'Analytics Engagement/Business Translation', 1: 'CMI', 2: 'Consumer/Shopper Insights', 3: 'Data Analysis & Visualization', 4: 'Data Engagement', 5: 'Data Engineer', 6: 'Data Modelling/Visualization', 7: 'Data Operations', 8: 'Data Product Design', 9: 'Data Product Management', 10: 'Data Quality', 11: 'Data Scientist', 12: 'Data Steward', 13: 'Master Data Governance', 14: 'Statistician', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Digital Technologies': {0: 'Applications Development', 1: 'Artificial Intelligence & Automation', 2: 'Artificial Intelligence & Innovation', 3: 'Automation', 4: 'BAI Infrastructure', 5: 'BI Applications', 6: 'Capabilities Development', 7: 'Digital Capability', 8: 'Engineer- IT', 9: 'Engineer- Security', 10: 'Enterprise Cloud', 11: 'ERP Business Analysis', 12: 'ERP Business Analysis- SAP', 13: 'Functional Applications', 14: 'Functional Information Delivery', 15: 'Infrastructure Engineer', 16: 'Integrity Monitoring', 17: 'IT Architect', 18: 'IT Business Partner', 19: 'IT Business Partnership Analysis', 20: 'IT Business Systems Analysis', 21: 'IT Business Transformation', 22: 'IT Communications', 23: 'IT Database Administration', 24: 'IT Deployment', 25: 'IT Deployment- ERP', 26: 'IT Deployment- SAP', 27: 'IT Functional Business Partner', 28: 'IT Infrastructure', 29: 'IT Operations', 30: 'IT Product Manager', 31: 'IT Project Manager', 32: 'IT Risk', 33: 'IT Service Analysis', 34: 'IT Service Controls', 35: 'IT Service Delivery', 36: 'IT Service Management', 37: 'IT Service Management- ERP Applications', 38: 'IT Service Management- Non ERP Applications', 39: 'IT Template Management', 40: 'Networks', 41: 'Next Generation Technology', 42: 'Non SAP Applications', 43: 'Platforms- Data Analytics', 44: 'Process Governance', 45: 'Processing Analysis', 46: 'SAP Applications', 47: 'Security Assurance & Compliance', 48: 'Security Awareness & Education', 49: 'Security Operations', 50: 'Service Desk', 51: 'Service Operations Process', 52: 'Site IT Services', 53: 'Software Developer', 54: 'Software Engineer', 55: 'Supplier Relationship Management', 56: 'User Experience & User Interface - UX/UI', 57: 'Web Development', 58: '', 59: ''}, 'Finance': {0: 'Accounting', 1: 'Accounts Payable', 2: 'Accounts Receivable', 3: 'Benefits', 4: 'Controller', 5: 'Finance Business Partner', 6: 'Finance Data & Systems', 7: 'Finance Transformation', 8: 'Financial Operations', 9: 'Internal Audit', 10: 'Investments', 11: 'Payroll & Travel/Expenses', 12: 'Risk Management', 13: 'Strategy & Corporate Development', 14: 'Tax', 15: 'Trade Accounting', 16: 'Treasury & Currency', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Leadership': {0: 'General Manager', 1: 'Mars Ambassador', 2: '', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Legal': {0: 'General Counsel', 1: 'Intellectual Property', 2: 'Legal Operations', 3: 'Marketing Properties', 4: 'Marketing Properties Specialist', 5: 'Paralegal', 6: 'Patent Agent- Intellectual Properties', 7: 'Systems & Docketing', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Marketing': {0: 'Brand/Portfolio Management', 1: 'Content Marketing', 2: 'Digital Marketing', 3: 'Editorial Content Management', 4: 'Event', 5: 'Graphic Design', 6: 'Licensing', 7: 'Marketing', 8: 'Marketing Acceleration', 9: 'Marketing Innovation', 10: 'Marketing Operations', 11: 'Media', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'P&O': {0: 'Associate Experience', 1: 'Associate Relations', 2: 'Associate Rewards', 3: 'Delivery Support', 4: 'Early Talent', 5: 'Employer Reputation', 6: 'Engagement', 7: 'Executive Rewards', 8: 'Functional Expert- P&O Solutions', 9: 'Global Mobility', 10: 'Inclusion & Diversity', 11: 'Learning Operations', 12: 'Learning Strategy', 13: 'Medical Assistant', 14: 'Occupational Doctor', 15: 'Occupational Health', 16: 'Occupational Health Nurse', 17: 'Organizational Development', 18: 'P&O', 19: 'P&O Business Partner', 20: 'P&O Business Relationship Manager', 21: 'P&O Contact Center', 22: 'P&O Content Management', 23: 'P&O Effectiveness', 24: 'P&O Process Owner', 25: 'P&O Service & Operations', 26: 'P&O Service Excellence', 27: 'P&O Transaction Center', 28: 'P&O Transformation', 29: 'Recruitment', 30: 'Recruitment Process Outsourcing - RPO', 31: 'Reporting', 32: 'Rewards Process Owner', 33: 'Talent Learning & Organization', 34: 'Talent Management', 35: 'Talent Process Owner', 36: 'Talent Sourcing', 37: 'Wellbeing', 38: 'Workplace Strategy', 39: 'Works Council', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'R&D': {0: 'Certification & Compliance', 1: 'Chemistry', 2: 'External Manufacturing Quality Assurance', 3: 'Functional Expert- Laboratory Systems', 4: 'Functional Expert- Packaging Technology & Systems', 5: 'Functional Expert- Quality Management Systems', 6: 'Functional Expert- R&D', 7: 'Good Manufacturing Practices', 8: 'Lab Client Value & Governance', 9: 'Laboratory Analysis', 10: 'Laboratory Management', 11: 'Microbiology', 12: 'Packaging Design/Development', 13: 'Pet Center', 14: 'Process & Material', 15: 'Process Development', 16: 'Product & Process Implementation', 17: 'Product Design/Development', 18: 'Product Development', 19: 'Product/Process', 20: 'Quality & Food Safety', 21: 'Quality & Food/Product Safety - Retail', 22: 'Quality Assurance', 23: 'Quality Control', 24: 'Quality Engineering', 25: 'Quality Management', 26: 'R&D Capability', 27: 'R&D Data Governance Analysis', 28: 'R&D Engineer', 29: 'R&D Operations', 30: 'R&D Program Management', 31: 'Research & Development', 32: 'Science Research', 33: 'Scientific & Regulatory Affairs', 34: 'Scientist', 35: 'Sensory', 36: 'Sterilization', 37: 'Technician- Laboratory', 38: 'Technician- Product Quality', 39: 'Technician- Quality', 40: 'Technician- Science Research', 41: 'Technician- Sensory', 42: 'Technologist- Implementation', 43: 'Technologist- Laboratory', 44: 'Technologist- Laboratory Systems', 45: 'Technologist- R&D', 46: 'Technologist- Sensory', 47: 'Toxicology', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Sales': {0: 'Activity Development', 1: 'Broker Management', 2: 'Business Operation Planning & Allocation - Retail', 3: 'Category & Customer Marketing', 4: 'Category Development/Management', 5: 'Category Management Analysis', 6: 'Category Strategy', 7: 'Channel Development/Management', 8: 'Customer Activation', 9: 'Customer Capabilities', 10: 'Customer Service/Operations', 11: 'Customer/Trade Marketing', 12: 'Demand Planning', 13: 'Design - Retail', 14: 'Digital Merchandising', 15: 'Distributor Development/Management', 16: 'Distributors Development - Pet', 17: 'Experience - Retail', 18: 'Field Sales Management', 19: 'Functional Expert- Sales Operations Systems', 20: 'Guest Experience', 21: 'Inside Sales Representative', 22: 'Key Account/Customer Development Management - E-Commerce/Digital', 23: 'Key Account/Customer Development Management', 24: 'Loss Prevention', 25: 'Merchandising', 26: 'New Transactions', 27: 'Perfect Store', 28: 'Physical Retail', 29: 'Pillar Management', 30: 'POSM/Display Development', 31: 'Retail Merchandising', 32: 'Retail Operations', 33: 'Retail Workforce Management', 34: 'Sales & Marketing', 35: 'Sales Analysis', 36: 'Sales Capability', 37: 'Sales Effectiveness', 38: 'Sales Management', 39: 'Sales Operations Analysis', 40: 'Sales Operations/Administration', 41: 'Sales Representative', 42: 'Sales Representative - PRO', 43: 'Sales Representative - SPT', 44: 'Sales Representative - VET', 45: 'Sales Representative- Trainer', 46: 'Sales Training', 47: 'Sales Transformation', 48: 'Shopper Marketing', 49: 'Sponsorship', 50: 'Sponsorships & Family Properties', 51: 'Store Administration', 52: 'Store Administration - Training', 53: 'Store Management', 54: 'Store Operations', 55: 'Strategic Demand', 56: 'Strategic Revenue Management', 57: 'Tele-Sales', 58: 'Training - Retail', 59: 'Visual - Retail'}, 'Service Provider': {0: 'Default Global RT', 1: 'Service Provider Recording Belarus', 2: 'Service Provider Recording Kazakhstan', 3: 'Service Provider Recording Russia', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Supply': {0: 'Customer Care', 1: 'Customer Care Process Owner', 2: 'Customer Order Processing', 3: 'Distribution Center', 4: 'Driver', 5: 'Engineer', 6: 'Engineer- Electrical', 7: 'Engineer- Mechanical', 8: 'Engineer- Production Process', 9: 'Engineer- Reliability/Maintenance', 10: 'Engineering & Industrial Engineering', 11: 'External Manufacturing Management', 12: 'Field/Agriculture', 13: 'Flow', 14: 'Forklift Driver', 15: 'Functional Expert- Distribution Systems', 16: 'Functional Expert- Logistics Systems', 17: 'Functional Expert- Supply Chain Systems', 18: 'Health, Safety & Environment', 19: 'Import & Export', 20: 'Industrial Engineer', 21: 'Lean Manufacturing', 22: 'Logistics', 23: 'Logistics Analysis', 24: 'Logistics Planning', 25: 'Manufacturing', 26: 'Manufacturing Production Management', 27: 'Manufacturing Technician', 28: 'Manufacturing- Value Stream', 29: 'Materials Handling', 30: 'Operator', 31: 'Operator- Logistics', 32: 'Operator- Packaging', 33: 'Packaging Logistics', 34: 'Plant/Site', 35: 'Production Planner', 36: 'Production Process Engineering', 37: 'Production/Operations', 38: 'Project Engineer', 39: 'Reliability/Maintenance', 40: 'Reliability/Maintenance- Electrical', 41: 'Reliability/Maintenance- Utilities', 42: 'Reliability/Maintenance-NP', 43: 'Supply Capability/Training', 44: 'Supply Chain', 45: 'Supply Chain Development', 46: 'Supply Chain Process Owner', 47: 'Supply Chain Transformation', 48: 'Supply Planner', 49: 'Technician- Industrial Engineering', 50: 'Technician- Mechanical', 51: 'Technician- Packing', 52: 'Trade Compliance', 53: 'Transport', 54: 'Warehouse', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Support Services': {0: 'Apprenticeship BACS+3 & below AP', 1: 'Aushilfe SW-NP', 2: 'Business Apprentice AP', 3: 'Cafeteria/Canteen', 4: 'Cleaning', 5: 'Cook/Chef', 6: 'Data Administration', 7: 'Digital Technologies Functional Program', 8: 'Executive Administration', 9: 'Facilities', 10: 'Facilities Maintenance', 11: 'Fleet Management', 12: 'General Service', 13: 'House Services', 14: 'Industrial Apprentice AP', 15: 'Internship', 16: 'Mail Room', 17: 'Office/Site Administration', 18: 'Receptionist', 19: 'Sanitation', 20: 'Secretary/Administrative', 21: 'Security', 22: 'Student Worker SW', 23: 'Technical Apprentice AP', 24: 'Technician- Facilities', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Veterinary': {0: 'Veterinarian', 1: 'Veterinary Nurse', 2: 'Veterinary Surgeon', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Job Class Short Name': {0: 'Business Integration', 1: 'Commercial', 2: 'Corporate Affairs', 3: 'Data, Analytics & Insights', 4: 'Digital Technologies', 5: 'Finance', 6: 'Leadership', 7: 'Legal', 8: 'Marketing', 9: 'P&O', 10: 'R&D', 11: 'Sales', 12: 'Service Provider', 13: 'Supply', 14: 'Support Services', 15: 'Veterinary', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}, 'Salary Class': {0: 'Junior', 1: 'Med', 2: 'Senior', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '', 13: '', 14: '', 15: '', 16: '', 17: '', 18: '', 19: '', 20: '', 21: '', 22: '', 23: '', 24: '', 25: '', 26: '', 27: '', 28: '', 29: '', 30: '', 31: '', 32: '', 33: '', 34: '', 35: '', 36: '', 37: '', 38: '', 39: '', 40: '', 41: '', 42: '', 43: '', 44: '', 45: '', 46: '', 47: '', 48: '', 49: '', 50: '', 51: '', 52: '', 53: '', 54: '', 55: '', 56: '', 57: '', 58: '', 59: ''}}
df_dropdowns_dv2 = pd.DataFrame(DROPDOWNS_DV2)

CONDITIONAL_F = {'apply_to': {0: 'ID', 1: 'Supplier', 2: 'Supplier comment', 3: 'Worker Email', 4: 'First Name', 5: 'Last Name', 6: 'ACTIVE WORKER?', 7: 'Job Class Short Name', 8: 'Job Title', 9: 'Salary Class', 10: 'IR35 Status', 11: 'Worker Date of Birth', 12: 'Worker Gender', 13: 'Worker Address Line 1', 14: 'Current Assignment Start Date', 15: 'Validation Start Date', 16: 'Current Assignment End Date', 17: 'Validation End Date', 18: 'Notice Period', 19: 'Remote worker?', 20: 'State in which the worker is based', 21: 'Worker Pay Type Name', 22: 'PO Number', 23: 'VALIDATION PO', 24: 'Rate type', 25: 'Standard Pay Rate', 26: 'Markup %', 27: 'Standard Supplier Bill Rate', 28: 'Supplier', 29: 'Worker Email', 30: 'First Name', 31: 'Last Name', 32: 'ACTIVE WORKER?', 33: 'Job Class Short Name', 34: 'Job Title', 35: 'Salary Class', 36: 'Worker Gender', 37: 'Worker Address Line 1', 38: 'Validation End Date', 39: 'Remote worker?', 40: 'Worker Pay Type Name', 41: 'PO Number', 42: 'Rate type', 43: 'Standard Pay Rate', 44: 'Markup %', 45: 'Current Assignment Start Date', 46: 'Validation Start Date', 47: 'Current Assignment End Date', 48: 'Validation End Date', 49: 'PO Number', 50: 'VALIDATION PO', 51: 'Standard Pay Rate', 52: 'Markup %'}, 'type': {0: 'formula', 1: 'formula', 2: 'formula', 3: 'formula', 4: 'formula', 5: 'formula', 6: 'formula', 7: 'formula', 8: 'formula', 9: 'formula', 10: 'formula', 11: 'formula', 12: 'formula', 13: 'formula', 14: 'formula', 15: 'formula', 16: 'formula', 17: 'formula', 18: 'formula', 19: 'formula', 20: 'formula', 21: 'formula', 22: 'formula', 23: 'formula', 24: 'formula', 25: 'formula', 26: 'formula', 27: 'formula', 28: 'formula', 29: 'formula', 30: 'formula', 31: 'formula', 32: 'formula', 33: 'formula', 34: 'formula', 35: 'formula', 36: 'formula', 37: 'formula', 38: 'formula', 39: 'formula', 40: 'formula', 41: 'formula', 42: 'formula', 43: 'formula', 44: 'formula', 45: 'formula', 46: 'formula', 47: 'formula', 48: 'formula', 49: 'formula', 50: 'formula', 51: 'formula', 52: 'formula'}, 'criteria': {0: '=$G4="LEAVER"', 1: '=$G4="LEAVER"', 2: '=$G4="LEAVER"', 3: '=$G4="LEAVER"', 4: '=$G4="LEAVER"', 5: '=$G4="LEAVER"', 6: '=$G4="LEAVER"', 7: '=$G4="LEAVER"', 8: '=$G4="LEAVER"', 9: '=$G4="LEAVER"', 10: '=$G4="LEAVER"', 11: '=$G4="LEAVER"', 12: '=$G4="LEAVER"', 13: '=$G4="LEAVER"', 14: '=$G4="LEAVER"', 15: '=$G4="LEAVER"', 16: '=$G4="LEAVER"', 17: '=$G4="LEAVER"', 18: '=$G4="LEAVER"', 19: '=$G4="LEAVER"', 20: '=$G4="LEAVER"', 21: '=$G4="LEAVER"', 22: '=$G4="LEAVER"', 23: '=$G4="LEAVER"', 24: '=$G4="LEAVER"', 25: '=$G4="LEAVER"', 26: '=$G4="LEAVER"', 27: '=$G4="LEAVER"', 28: '=AND($E4<>"",$B4="")', 29: '=AND($E4<>"",$D4="")', 30: '=AND($E4<>"",$E4="")', 31: '=AND($E4<>"",$F4="")', 32: '=AND($E4<>"",$G4="")', 33: '=AND($E4<>"",$H4="")', 34: '=AND($E4<>"",$I4="")', 35: '=AND($E4<>"",$J4="")', 36: '=AND($E4<>"",$L4="")', 37: '=AND($E4<>"",$M4="")', 38: '=AND($E4<>"",$Q4="")', 39: '=AND($E4<>"",$S4="")', 40: '=AND($E4<>"",$U4="")', 41: '=AND($E4<>"",$V4="")', 42: '=AND($E4<>"",$X4="")', 43: '=AND($E4<>"",$Y4="")', 44: '=AND($E4<>"",$Z4="")', 45: '=LEFT($O4,7)="INVALID"', 46: '=LEFT($O4,7)="INVALID"', 47: '=LEFT($Q4,7)="INVALID"', 48: '=LEFT($Q4,7)="INVALID"', 49: '=LEFT($W4,7)="INVALID"', 50: '=LEFT($W4,7)="INVALID"', 51: '=AND(IFERROR($Y4*1,0)<=0,$Y4<>"")', 52: '=AND(IFERROR($Z4*1,0)<=0,$Z4<>"")'}, 'format': {0: 'format_11', 1: 'format_11', 2: 'format_11', 3: 'format_11', 4: 'format_11', 5: 'format_11', 6: 'format_11', 7: 'format_11', 8: 'format_11', 9: 'format_11', 10: 'format_11', 11: 'format_11', 12: 'format_11', 13: 'format_11', 14: 'format_11', 15: 'format_11', 16: 'format_11', 17: 'format_11', 18: 'format_11', 19: 'format_11', 20: 'format_11', 21: 'format_11', 22: 'format_11', 23: 'format_11', 24: 'format_11', 25: 'format_11', 26: 'format_11', 27: 'format_11', 28: 'format_12', 29: 'format_12', 30: 'format_12', 31: 'format_12', 32: 'format_12', 33: 'format_12', 34: 'format_12', 35: 'format_12', 36: 'format_12', 37: 'format_12', 38: 'format_12', 39: 'format_12', 40: 'format_12', 41: 'format_12', 42: 'format_12', 43: 'format_12', 44: 'format_12', 45: 'format_14', 46: 'format_14', 47: 'format_14', 48: 'format_14', 49: 'format_14', 50: 'format_14', 51: 'format_14', 52: 'format_14'}, 'Comms': {0: 'LEAVERS', 1: 'LEAVERS', 2: 'LEAVERS', 3: 'LEAVERS', 4: 'LEAVERS', 5: 'LEAVERS', 6: 'LEAVERS', 7: 'LEAVERS', 8: 'LEAVERS', 9: 'LEAVERS', 10: 'LEAVERS', 11: 'LEAVERS', 12: 'LEAVERS', 13: 'LEAVERS', 14: 'LEAVERS', 15: 'LEAVERS', 16: 'LEAVERS', 17: 'LEAVERS', 18: 'LEAVERS', 19: 'LEAVERS', 20: 'LEAVERS', 21: 'LEAVERS', 22: 'LEAVERS', 23: 'LEAVERS', 24: 'LEAVERS', 25: 'LEAVERS', 26: 'LEAVERS', 27: 'LEAVERS', 28: 'Mandatory Values for extra rows', 29: 'Mandatory Values for extra rows', 30: 'Mandatory Values for extra rows', 31: 'Mandatory Values for extra rows', 32: 'Mandatory Values for extra rows', 33: 'Mandatory Values for extra rows', 34: 'Mandatory Values for extra rows', 35: 'Mandatory Values for extra rows', 36: 'Mandatory Values for extra rows', 37: 'Mandatory Values for extra rows', 38: 'Mandatory Values for extra rows', 39: 'Mandatory Values for extra rows', 40: 'Mandatory Values for extra rows', 41: 'Mandatory Values for extra rows', 42: 'Mandatory Values for extra rows', 43: 'Mandatory Values for extra rows', 44: 'Mandatory Values for extra rows', 45: 'VALIDATION DATE FORMAT', 46: 'VALIDATION DATE FORMAT', 47: 'VALIDATION DATE FORMAT', 48: 'VALIDATION DATE FORMAT', 49: 'VALIDATION PO Number starting with 47', 50: 'VALIDATION PO Number starting with 47', 51: 'VALIDATION Number > 0', 52: 'VALIDATION Number > 1'}}
df_condf = pd.DataFrame(CONDITIONAL_F)


def set_idx_format(workbook: xlsxwriter.workbook.Workbook, worksheet: xlsxwriter.worksheet.Worksheet, df: pd.DataFrame) -> None:

    idx_format = workbook.add_format({'text_wrap':True, 'bold':True, 'italic':True, 'right':True})
    other_cols_format = workbook.add_format({'text_wrap':True})

    columns = iter(df.columns)
    col = next(columns)
    worksheet.set_column(col, col, width=20, cell_format=idx_format)
    for col in columns:
        worksheet.set_column(col, col, width=20, cell_format=other_cols_format)


def config_file() -> None:

    with pd.ExcelWriter('XlFileTemp_config_file.xlsx', engine='xlsxwriter') as writer:
        wb = writer.book

        orange_bg_color = wb.add_format({'bg_color': '#ff9900', 'text_wrap':True})
        comments_format = {'visible': True, 'font_size': 10, 'height': 230, 'width': 200}

        ### FORMATS Sheet
        ws_format = wb.add_worksheet(name='FORMATS')
        ws_format.set_tab_color('#80ccff')
        for i, format_ in enumerate(format_dict.keys()):
            ws_format.write_string(i,0, format_, cell_format=wb.add_format(format_dict[format_]))
        ws_format.set_column(0, 0, width=17)

        column_formats = format_lock_config_dict.keys()
        ws_format.write(0,1,'COLUMN FORMATS')
        ws_format.write_column(1,1,column_formats)
        ws_format.set_column(1, 1, width=20)

        ### IMPORT_FILE Sheet
        df_impf.to_excel(writer,sheet_name='IMPORT_FILE', header=False, index=False)
        ws_root = writer.sheets['IMPORT_FILE']
        ws_root.set_tab_color('#0000ff')
        
        ### MAIN_SHEET
        df_main.to_excel(writer, sheet_name='MAIN_SHEET', header=False, index=False)
        ws_main = writer.sheets['MAIN_SHEET']
        ws_main.set_tab_color('#00ff00')

        set_idx_format(wb, ws_main, df_main)
        ws_main.write(0,1, df_main.iloc[0,1], orange_bg_color)
        ws_main.write(6,1, df_main.iloc[6,1], orange_bg_color)

        ws_main.data_validation('A7:A100', {'validate': 'list', 'source': ['description_header','HEADER','example_row']})
        ws_main.data_validation('B3:AM3', {'validate': 'list', 'source': ['','Mandatory']})
        ws_main.data_validation('B4:AM4', {'validate': 'list', 'source': f'=FORMATS!$A$1:$A${len(format_dict)}'})
        ws_main.data_validation('B5:AM5', {'validate': 'list', 'error_type': 'warning', 'error_message': 'This column will be locked by default','source': f'=FORMATS!$B$2:$B${len(format_lock_config_dict)+1}'})

        ws_main.write_comment('P6', 'Select the entire formula row range and Use Search and Replace to replace \ for \' to keep the formula visible including the \'=\' sign', comments_format)
        ws_main.write_comment('R6', 'Select the entire formula row range and Use Search and Replace to replace \ for \' to keep the formula visible including the \'=\' sign', comments_format)
        ws_main.write_comment('X6', 'Select the entire formula row range and Use Search and Replace to replace \ for \' to keep the formula visible including the \'=\' sign', comments_format)
        ws_main.write_comment('AB6', 'Select the entire formula row range and Use Search and Replace to replace \ for \' to keep the formula visible including the \'=\' sign', comments_format)

        ### Conditional Formatting
        df_condf.to_excel(writer, sheet_name='conditional_formatting', index=False)
        ws_condf = writer.sheets['conditional_formatting']
        ws_condf.data_validation('D2:D100', {'validate': 'list', 'source': f'=FORMATS!$A$1:$A${len(format_dict)}'})
        ws_condf.data_validation('B2:B100', {'validate': 'list', 'source': ['','formula']})
        ws_condf.set_tab_color('#ff00ff')
        ws_condf.write_comment('C1', 'Use Search and Replace to replace \ for \' to keep the formula visible including the \'=\' sign\nThe order of the conditions matters. A new condition do not overwrite a previous condition.\nThe conditions in the conditional_formatting sheet are superimposed over the Mandatory fields.\nThe mandtory flag does not overwrite an existing condition in the conditional_formatting sheet', comments_format)

        ### Data Validation 1 sheet
        dv_config1.to_excel(writer, sheet_name='data_validation_config1', header=False, index=False)
        ws_dv = writer.sheets['data_validation_config1']
        ws_dv.set_tab_color('#FF9900')

        set_idx_format(wb, ws_dv, dv_config1)
        ws_dv.write(0,1, dv_config1.iloc[0,1], orange_bg_color)
        
        ws_dv.write_row('B7:AM7', dv_config1.iloc[6,1:].tolist(), wb.add_format({'bold':1, 'text_wrap':1}))

        ws_dv.data_validation('A3:A100', {'validate': 'list', 'source': ['error_type','input_title','input_message','error_title','error_message','HEADER']})
        ws_dv.data_validation('B2:AM2', {'validate': 'list', 'source': ['stop','warning','information']})

        ### Data Validation 2 sheet
        dv_config2.to_excel(writer, sheet_name='data_validation_config2', index=False)
        ws_dv2 = writer.sheets['data_validation_config2']
        ws_dv2.data_validation('D2:D50', {'validate': 'list', 'source': ['stop','warning','information']})
        ws_dv2.data_validation('B2:B50', {'validate': 'list', 'source': ['','list']})
        ws_dv2.set_tab_color('#9900ff')
        ws_dv2.write_comment('C1', 'Use Search and Replace to replace \ for \' to keep the formula visible including the \'=\' sign\n', comments_format)

        ### Dropdown lists DV2
        df_dropdowns_dv2.to_excel(writer, sheet_name='dropdown_lists_config2', index=False)

        